import {
  Entity,
  Column,
  BaseEntity,
  PrimaryGeneratedColumn,
  ManyToOne,
  JoinColumn,
} from 'typeorm';
import { Package } from './Package';

@Entity()
export class Vulnerability extends BaseEntity {
  @PrimaryGeneratedColumn()
  id!: string;

  @Column()
  ecosystem!: string;

  @Column()
  packageName!: string;

  @Column()
  title!: string;

  @Column()
  description!: string;

  @Column()
  severity!: string;

  @Column('simple-array')
  references!: string[];

  @Column('simple-array')
  identifiers!: string[];

  @Column('simple-array')
  patchedVersions!: string[];

  @Column('simple-array')
  vulnerableVersions!: string[];

  @ManyToOne('Package', 'vulnerabilities')
  @JoinColumn([
    { name: 'packageName', referencedColumnName: 'packageName' },
    { name: 'ecosystem', referencedColumnName: 'ecosystem' },
  ])
  package!: Package;
}
